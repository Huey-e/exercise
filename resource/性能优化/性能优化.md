- [å¤§å‚æŠ€æœ¯çˆ†è‚æ—¥æ›´ç²¾é€‰å¥½æ–‡](#å¤§å‚æŠ€æœ¯çˆ†è‚æ—¥æ›´ç²¾é€‰å¥½æ–‡)
- [å¸¸ç”¨çš„æ€§èƒ½æŒ‡æ ‡](#å¸¸ç”¨çš„æ€§èƒ½æŒ‡æ ‡)
  - [First Paint(FP) é¦–æ¬¡ç»˜åˆ¶](#first-paintfp-é¦–æ¬¡ç»˜åˆ¶)
  - [First Contentful Paint(FCP) é¦–æ¬¡å†…å®¹ç»˜åˆ¶](#first-contentful-paintfcp-é¦–æ¬¡å†…å®¹ç»˜åˆ¶)
  - [Largest Contentful Paint (LCP) æœ€å¤§å†…å®¹ç»˜åˆ¶](#largest-contentful-paint-lcp-æœ€å¤§å†…å®¹ç»˜åˆ¶)
  - [First Meaningful Paint(FMP) é¦–æ¬¡æœ‰æ•ˆç»˜åˆ¶](#first-meaningful-paintfmp-é¦–æ¬¡æœ‰æ•ˆç»˜åˆ¶)
  - [First Input Delay(FID) é¦–æ¬¡è¾“å…¥å»¶è¿Ÿ](#first-input-delayfid-é¦–æ¬¡è¾“å…¥å»¶è¿Ÿ)
  - [Cumulative Layout Shift(CLS) ç´¯ç§¯å¸ƒå±€åç§»](#cumulative-layout-shiftcls-ç´¯ç§¯å¸ƒå±€åç§»)
  - [Time to Interactive(TTI) å¯äº¤äº’æ—¶é—´](#time-to-interactivetti-å¯äº¤äº’æ—¶é—´)
  - [DOMContentLoaded(DCL)](#domcontentloadeddcl)
  - [Load(L)](#loadl)
- [å¸¸è§çš„æ€§èƒ½åè¯](#å¸¸è§çš„æ€§èƒ½åè¯)
  - [ä»¥ç”¨æˆ·ä¸ºä¸­å¿ƒçš„æ€§èƒ½æŒ‡æ ‡ (user-centric metric)](#ä»¥ç”¨æˆ·ä¸ºä¸­å¿ƒçš„æ€§èƒ½æŒ‡æ ‡-user-centric-metric)
  - [æ ¹æ®é‡‡é›†æ–¹å¼ä¸åŒï¼Œæ€§èƒ½æŒ‡æ ‡çš„å‡ ç§å½¢å¼](#æ ¹æ®é‡‡é›†æ–¹å¼ä¸åŒæ€§èƒ½æŒ‡æ ‡çš„å‡ ç§å½¢å¼)
    - [Lab Data / SYN](#lab-data--syn)
    - [Field Data / RUM](#field-data--rum)
  - [RAIL Model](#rail-model)
- [æ€§èƒ½æŒ‡æ ‡æ˜¯æ€ä¹ˆé‡‡é›†çš„](#æ€§èƒ½æŒ‡æ ‡æ˜¯æ€ä¹ˆé‡‡é›†çš„)
  - [æ€§èƒ½æŒ‡æ ‡ç›¸å…³çš„ API åŠé‡‡é›†æ–¹å¼](#æ€§èƒ½æŒ‡æ ‡ç›¸å…³çš„-api-åŠé‡‡é›†æ–¹å¼)
    - [Performance Observer\[1\]](#performance-observer1)
      - [Paint Timing API\[2\]](#paint-timing-api2)
      - [Largest Contentful Paint API\[3\]](#largest-contentful-paint-api3)
      - [Event Timing API\[4\]](#event-timing-api4)
      - [Navigation Timing 1.0\[5\] æˆ– Navigation Timing 2.0\[6\]](#navigation-timing-105-æˆ–-navigation-timing-206)
      - [Layout Instability API\[7\]](#layout-instability-api7)
      - [Long Tasks API\[8\] \& Resource Timing API\[9\]](#long-tasks-api8--resource-timing-api9)
    - [Mutation\[11\]\[12\]Observer\[13\]](#mutation1112observer13)
  - [ä¸šç•Œæ€§èƒ½æŒ‡æ ‡é‡‡é›†å·¥å…·](#ä¸šç•Œæ€§èƒ½æŒ‡æ ‡é‡‡é›†å·¥å…·)
    - [In the Lab](#in-the-lab)
    - [In the Field](#in-the-field)
- [å‚è€ƒ](#å‚è€ƒ)
    - [å‚è€ƒèµ„æ–™](#å‚è€ƒèµ„æ–™)

# å¤§å‚æŠ€æœ¯çˆ†è‚æ—¥æ›´ç²¾é€‰å¥½æ–‡    

å‰ä¸€æ®µæ—¶é—´ï¼Œæˆ‘ä»¬å¯¹ webview åšäº†ä¸€æœŸæ€§èƒ½ä¼˜åŒ–ï¼Œåœ¨ä¼˜åŒ–è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬è¿½æ±‚çš„æ˜¯é¡µé¢è¦è¶³å¤Ÿã€Œå¿«ã€ã€Œç¨³ã€ã€‚é‚£æ€ä¹ˆå®šé‡åœ°è¡¡é‡è¿™ä¸ªã€Œå¿«ã€ã€Œç¨³ã€å‘¢ï¼Ÿæ€§èƒ½æŒ‡æ ‡å¸®åŠ©æˆ‘ä»¬ä»æ•°æ®åŒ–è§’åº¦äº†è§£é¡µé¢æ€§èƒ½ç°çŠ¶ï¼Œæ€§èƒ½ç“¶é¢ˆä»¥åŠä¼˜åŒ–å®Œæˆåï¼Œè¡¡é‡ä¼˜åŒ–æ•ˆæœã€‚

æ€§èƒ½æŒ‡æ ‡åœ¨æ—¥å¸¸å¼€å‘ä¸­ï¼Œå¤§å®¶æˆ–å¤šæˆ–å°‘çš„éƒ½æœ‰æ¥è§¦ã€‚æ¯”å¦‚ğŸ‘‡ æ˜¯ä¸€ä¸ªé¡µé¢åœ¨ Lighthouse ä¸‹è·‘å‡ºæ¥çš„æ€§èƒ½æ•°æ®ã€‚

![image_59cc4e6d.png](http://markdown.liangtengyu.com:9999/images//image_59cc4e6d.png)

è¿™ç¯‡æ–‡ç« å°†å›ç­”ä¸‹é¢å‡ ä¸ªé—®é¢˜ï¼š

 *  å“ªäº›æ€§èƒ½æŒ‡æ ‡æ˜¯éœ€è¦è§‚æµ‹çš„ï¼Ÿå®ƒä»¬æ˜¯ä»€ä¹ˆå«ä¹‰ï¼Ÿ
 *  è¿™ä¹ˆå¤šæŒ‡æ ‡ï¼Œæˆ‘ä»¬åœ¨ä»€ä¹ˆåœºæ™¯ä¸‹åº”è¯¥å…³æ³¨å“ªäº›ï¼Ÿ
 *  æŒ‡æ ‡æ˜¯æ€ä¹ˆé‡‡é›†çš„ï¼Ÿ

# å¸¸ç”¨çš„æ€§èƒ½æŒ‡æ ‡ 

 *  First Paint
 *  First Contentful Paint
 *  Largest Contentful Paint
 *  First Meaningful Paint
 *  First Input Delay
 *  Cumulative Layout Shift
 *  Time to Interactive
 *  DOMContentLoaded
 *  Load

## First Paint(FP) é¦–æ¬¡ç»˜åˆ¶ 

é¦–æ¬¡æ¸²æŸ“çš„æ—¶é—´ç‚¹ï¼Œå¯ä»¥è§†ä¸ºç™½å±æ—¶é—´ï¼Œæ¯”å¦‚å®ŒæˆèƒŒæ™¯è‰²æ¸²æŸ“çš„æ—¶é—´ç‚¹ã€‚é€šå¸¸ä½œä¸ºæ—¶é—´ç‚¹æœ€æ—©çš„ä¸€ä¸ªæ€§èƒ½æŒ‡æ ‡ã€‚

## First Contentful Paint(FCP) é¦–æ¬¡å†…å®¹ç»˜åˆ¶ 

é¦–æ¬¡æœ‰å†…å®¹æ¸²æŸ“çš„æ—¶é—´ç‚¹ï¼ŒæŒ‡æ ‡æµ‹é‡é¡µé¢ä»å¼€å§‹åŠ è½½åˆ°é¡µé¢å†…å®¹çš„ä»»ä½•éƒ¨åˆ†åœ¨å±å¹•ä¸Šå®Œæˆæ¸²æŸ“çš„æ—¶é—´ã€‚å¯¹äºè¯¥æŒ‡æ ‡ï¼Œ"å†…å®¹"æŒ‡çš„æ˜¯æ–‡æœ¬ã€å›¾åƒã€`<svg>`å…ƒç´ æˆ–éç™½è‰²çš„`<canvas>`å…ƒç´ ã€‚å¯ä»¥ä½œä¸ºé¦–å±æ—¶é—´ã€‚

> FP vs FCP
> 
> FPï¼šä»å¼€å§‹åŠ è½½åˆ°ç¬¬ä¸€æ¬¡æ¸²æŸ“
> 
> FCPï¼šä»å¼€å§‹åŠ è½½åˆ°ç¬¬ä¸€æ¬¡å†…å®¹æ¸²æŸ“ã€‚
> 
> FCP æ˜¯ FP çš„å¢å¼ºç‰ˆï¼Œå¯¹ç”¨æˆ·æ¥è¯´æ›´å…³é”®ã€‚å› ä¸º FCP å¸¦ç€å›¾åƒå’Œæ–‡å­—è¿™äº›å†…å®¹ä¿¡æ¯ï¼Œæ˜¯ç”¨æˆ·æ›´å…³å¿ƒçš„ã€‚
> 
> FP å’Œ FCP å¯èƒ½æ˜¯é‡åˆçš„ã€‚

![image_3f98b5c0.png](http://markdown.liangtengyu.com:9999/images//image_3f98b5c0.png)

## Largest Contentful Paint (LCP) æœ€å¤§å†…å®¹ç»˜åˆ¶ 

é¡µé¢çš„æœ€å¤§å†…å®¹ï¼ˆé€šå¸¸æ˜¯æ¯”è¾ƒæ ¸å¿ƒçš„å†…å®¹ï¼‰åŠ è½½å®Œæˆçš„æ—¶é—´ï¼Œè¿™ä¸ªæœ€å¤§å†…å®¹å¯ä»¥æ˜¯å›¾ç‰‡/æ–‡æœ¬å—ã€‚å®ƒæ˜¯ä¸€ä¸ª SEO ç›¸å…³çš„æŒ‡æ ‡ã€‚

> LCP vs FCP
> 
> FCPï¼šé¡µé¢åŠ è½½è¿‡ç¨‹ä¸­ï¼Œæ¯”è¾ƒæ—©æœŸçš„ä¸€ä¸ªæŒ‡æ ‡ï¼Œå¦‚æœä¸€ä¸ªé¡µé¢æœ‰ loading æ€ï¼Œè¿™ä¸ªæŒ‡æ ‡è¡¨ç°å¯èƒ½å¾ˆå¥½ï¼Œä½†æ˜¯å®é™…å†…å®¹ä»€ä¹ˆæ—¶å€™å‘ˆç°ç»™ç”¨æˆ·ï¼Œè¿™ä¸ªæŒ‡æ ‡æ²¡åŠæ³•è¡¡é‡ã€‚
> 
> LCPï¼šå…³æ³¨é¡µé¢æ ¸å¿ƒå†…å®¹å‘ˆç°æ—¶é—´ï¼Œè¿™ä¸ªå†…å®¹æ˜¯ç”¨æˆ·æ›´æ„Ÿå…´è¶£çš„ï¼Œæ›´åŠ ç”¨æˆ·ç›¸å…³ã€‚

![image_50b7662c.png](http://markdown.liangtengyu.com:9999/images//image_50b7662c.png)

## First Meaningful Paint(FMP) é¦–æ¬¡æœ‰æ•ˆç»˜åˆ¶ 

é¦–æ¬¡ç»˜åˆ¶æœ‰æ„ä¹‰å†…å®¹çš„æ—¶é—´ã€‚ä¸šç•Œæ¯”è¾ƒè®¤å¯çš„æ–¹å¼æ˜¯åœ¨åŠ è½½å’Œæ¸²æŸ“è¿‡ç¨‹ä¸­æœ€å¤§å¸ƒå±€å˜åŠ¨ä¹‹åçš„é‚£ä¸ªç»˜åˆ¶æ—¶é—´å³ä¸ºå½“å‰é¡µé¢çš„ FMPã€‚å› ä¸ºå®ƒè®¡ç®—ç›¸å¯¹å¤æ‚ï¼Œä¸”å­˜åœ¨å‡†ç¡®æ€§ç­‰é—®é¢˜ï¼ŒLighthouse 6.0 ä¸­è¢«åºŸå¼ƒã€‚

> LCP vs FMP
> 
> FMP: æ—©æœŸæ¯”è¾ƒæ¨èçš„æ€§èƒ½æŒ‡æ ‡ï¼Œä½†æ˜¯è®¡ç®—æ›´å¤æ‚ï¼Œè€Œä¸”å‡†ç¡®æ€§ä¸æ˜¯å¾ˆå¥½
> 
> LCP: æ›´æ–°çš„æ•°æ®æŒ‡æ ‡ï¼Œæœ‰ API ç›´æ¥æ”¯æŒï¼Œç»Ÿè®¡ç®€å•ï¼Œä¸”å‡†ç¡®ï¼Œä½†ä¹Ÿå­˜åœ¨æœ€å¤§å†…å®¹æ˜¯å¦ä¸ºæœ€æ ¸å¿ƒå†…å®¹è¿™æ ·çš„é—®é¢˜ã€‚

## First Input Delay(FID) é¦–æ¬¡è¾“å…¥å»¶è¿Ÿ 

è¿™ä¸ªæŒ‡æ ‡çš„è§¦å‘æ˜¯åœ¨ç”¨æˆ·ç¬¬ä¸€æ¬¡ä¸é¡µé¢äº¤äº’çš„çš„æ—¶å€™ï¼Œè®°å½•çš„æ˜¯æ˜¯ç”¨æˆ·ç¬¬ä¸€æ¬¡ä¸é¡µé¢äº¤äº’åˆ°æµè§ˆå™¨çœŸæ­£èƒ½å¤Ÿå¼€å§‹å¤„ç†äº‹ä»¶å¤„ç†ç¨‹åºä»¥å“åº”è¯¥äº¤äº’çš„æ—¶é—´ï¼Œå³äº¤äº’å»¶è¿Ÿæ—¶é—´ã€‚æ¯”å¦‚å‘ç”Ÿåœ¨ç”¨æˆ·ç¬¬ä¸€æ¬¡åœ¨é¡µé¢è¿›è¡Œ clickï¼Œ keydown ç­‰äº¤äº’ã€‚

ä¸ºä»€ä¹ˆä¼šæœ‰è¿™æ ·çš„å»¶è¿Ÿå‘¢ï¼Ÿä¸€èˆ¬æ¥è¯´ï¼Œå‘ç”Ÿè¾“å…¥å»¶è¿Ÿæ˜¯å› ä¸ºæµè§ˆå™¨çš„ä¸»çº¿ç¨‹æ­£å¿™ç€æ‰§è¡Œå…¶ä»–å·¥ä½œï¼ˆæ¯”å¦‚è§£æå’Œæ‰§è¡Œå¤§å‹ JS æ–‡ä»¶ï¼‰ï¼Œè¿˜ä¸èƒ½å“åº”ç”¨æˆ·ã€‚

## Cumulative Layout Shift(CLS) ç´¯ç§¯å¸ƒå±€åç§» 

åœ¨ä¸€ä¸ªé¡µé¢çš„ç”Ÿå‘½å‘¨æœŸä¸­ï¼Œä¼šä¸æ–­çš„å‘ç”Ÿå¸ƒå±€å˜åŒ–ï¼ˆlayout shiftï¼‰ï¼Œå¯¹æ¯ä¸€æ¬¡å¸ƒå±€å˜åŒ–åšä¸€ä¸ªç´¯ç§¯çš„è®°åˆ†ï¼Œå…¶ä¸­å¾—åˆ†æœ€å¤§å¸ƒå±€å˜åŒ–å³ä¸º CLSã€‚æ˜¯è¡¡é‡é¡µé¢ç¨³å®šæ€§çš„é‡è¦æŒ‡æ ‡ï¼ˆvisual stabilityï¼‰

ç³Ÿç³•çš„ CLS å¯¹ç”¨æˆ·ä½“éªŒçš„å½±å“ğŸ‘‡

![image_3bca44ca.png](http://markdown.liangtengyu.com:9999/images//image_3bca44ca.png)

> #### Core Web Vitals 
> 
> 2020 å¹´ 5 æœˆï¼ŒGoogle æå‡ºçš„è¡¡é‡ç½‘ç«™ç”¨æˆ·ä½“éªŒçš„æ ¸å¿ƒæ•°æ®æŒ‡æ ‡ï¼Œæ¶µç›–äº†é¡µé¢çš„åŠ è½½é€Ÿåº¦ã€å¯äº¤äº’æ€§å’Œç¨³å®šæ€§ã€‚æ˜¯è¿‘æœŸç”Ÿæ•ˆçš„ä¼šå½±å“ SEO çš„é‡è¦æŒ‡æ ‡ï¼ŒåŒ…å«ä¸€ä¸‹ä¸‰é¡¹ï¼š
> 
>  *  LCP
>  *  FID
>  *  CLS

## Time to Interactive(TTI) å¯äº¤äº’æ—¶é—´ 

è¯´åˆ° TTI é¦–å…ˆè¦ä»‹ç»ä¸‹ Long Task

> Long Taskï¼šå¦‚æœæµè§ˆå™¨ä¸»çº¿ç¨‹æ‰§è¡Œçš„ä¸€ä¸ª task è€—æ—¶å¤§äº 50msï¼Œé‚£ä¹ˆè¿™ä¸ª task ç§°ä¸º long taskã€‚ç”¨æˆ·çš„äº¤äº’æ“ä½œä¹Ÿæ˜¯åœ¨ä¸»çº¿ç¨‹æ‰§è¡Œçš„ï¼Œæ‰€ä»¥å½“å‘ç”Ÿ Long Task æ—¶ï¼Œç”¨æˆ·çš„äº¤äº’æ“ä½œå¾ˆå¯èƒ½æ— æ³•åŠæ—¶æ‰§è¡Œï¼Œè¿™æ—¶ç”¨æˆ·å°±ä¼šä½“éªŒåˆ°å¡é¡¿ï¼ˆå½“é¡µé¢å“åº”æ—¶é—´è¶…è¿‡ 100ms æ—¶ï¼Œç”¨æˆ·å¯ä»¥ä½“éªŒåˆ°å¡é¡¿ï¼‰ï¼Œè¿›è€Œå½±å“ç”¨æˆ·ä½“éªŒã€‚

ä»é¡µé¢åŠ è½½å¼€å§‹åˆ°é¡µé¢å¤„äºå®Œå…¨å¯äº¤äº’çŠ¶æ€æ‰€èŠ±è´¹çš„æ—¶é—´ã€‚é€šå¸¸æ˜¯å‘ç”Ÿåœ¨é¡µé¢ä¾èµ–çš„èµ„æºå·²ç»åŠ è½½å®Œæˆï¼Œæ­¤æ—¶æµè§ˆå™¨å¯ä»¥å¿«é€Ÿå“åº”ç”¨æˆ·äº¤äº’çš„æ—¶é—´ã€‚

## DOMContentLoaded(DCL) 

DOM åŠ è½½å®Œæˆå³è§¦å‘ï¼Œä¸ç”¨ç­‰é¡µé¢èµ„æºåŠ è½½ã€‚

## Load(L) 

é¡µé¢åŠå…¶ä¾èµ–çš„èµ„æºå…¨éƒ¨åŠ è½½å®Œæˆçš„æ—¶é—´ï¼ŒåŒ…æ‹¬æ‰€æœ‰çš„èµ„æºæ–‡ä»¶ï¼Œå¦‚æ ·å¼è¡¨å’Œå›¾ç‰‡ç­‰ã€‚

# å¸¸è§çš„æ€§èƒ½åè¯ 

## ä»¥ç”¨æˆ·ä¸ºä¸­å¿ƒçš„æ€§èƒ½æŒ‡æ ‡ (user-centric metric) 

ä¼ ç»Ÿæ€§èƒ½æŒ‡æ ‡ï¼š

å¾ˆé•¿æ—¶é—´ä»¥æ¥ï¼Œæè¿°æ€§èƒ½æ˜¯é€šè¿‡ Load/DOMContentLoaded äº‹ä»¶è¿›è¡Œæµ‹é‡çš„ï¼Œä¸€ä¸ªç½‘ç«™åŠ è½½å®Œæˆçš„æ—¶é—´æ˜¯å¤šå°‘ç§’ã€‚è™½ç„¶ Load/DOMContentLoaded æ˜¯é¡µé¢ç”Ÿå‘½å‘¨æœŸä¸­æ¯”è¾ƒæ˜ç¡®çš„æ—¶åˆ»ï¼Œä½†æ˜¯å®ƒçœŸçš„èƒ½å¾ˆå¥½çš„ååº”å®é™…ç”¨æˆ·è®¿é—®é¡µé¢çš„çœŸå®æ„Ÿå—å—ï¼Ÿ

æ¯”å¦‚ï¼ŒæœåŠ¡å™¨å¦‚æœå“åº”ä¸€ä¸ªå¾ˆå°çš„ä½“ç§¯çš„é¡µé¢ï¼ŒLoad/DOMContentLoaded ä¼šå¾ˆå¿«è§¦å‘ï¼Œç„¶åå¼‚æ­¥è·å–å†…å®¹ï¼Œä¹‹ååœ¨é¡µé¢ä¸Šæ˜¾ç¤ºã€‚è¿™æ ·çš„é¡µé¢ Load/DOMContentLoaded çš„æ—¶é—´å¾ˆçŸ­ï¼Œé‚£ä»ç”¨æˆ·ä½“éªŒè§’åº¦è®²å®ƒçš„æ€§èƒ½è¡¨ç°å°±æ˜¯å¥½çš„å—ï¼Ÿ

è¦å›ç­”ä¸Šé¢é—®é¢˜ï¼Œä¹Ÿå°±å¼•å‡ºäº†ğŸ‘‡ è¿™ä¸ªæ¦‚å¿µã€‚

ä»¥ç”¨æˆ·ä¸ºä¸­å¿ƒçš„æ€§èƒ½æŒ‡æ ‡ (user-centric metric)ï¼š

ä»¥ç”¨æˆ·ä¸ºä¸­å¿ƒçš„æ€§èƒ½æŒ‡æ ‡æ›´å…³æ³¨ä»ç”¨æˆ·è§’åº¦çœ‹ï¼Œé¡µé¢çš„æ€§èƒ½æ˜¯æ€æ ·çš„ï¼Ÿé¡µé¢å‘ˆç°çš„å†…å®¹æ˜¯ä¸æ˜¯æ»¡è¶³ç”¨æˆ·éœ€è¦ï¼Œç”¨æˆ·äº¤äº’èµ·æ¥æ˜¯å¦æµç•…ç­‰ã€‚ä¸Šé¢ä»‹ç»çš„ FCPã€LCPã€FMPã€FIDã€CLSã€TTI å‡æ˜¯ä»¥ç”¨æˆ·ä¸ºä¸­å¿ƒçš„æ€§èƒ½æŒ‡æ ‡

<table> 
 <thead> 
  <tr> 
   <th>æ˜¯å¦æ­£åœ¨å‘ç”Ÿï¼Ÿ</th> 
   <th>å¯¼èˆªæ˜¯å¦æˆåŠŸå¯åŠ¨ï¼ŸæœåŠ¡å™¨æœ‰å“åº”å—ï¼Ÿ</th> 
  </tr> 
 </thead> 
 <tbody> 
  <tr> 
   <td>æ˜¯å¦æœ‰ç”¨ï¼Ÿ</td> 
   <td>æ˜¯å¦æ¸²æŸ“äº†è¶³å¤Ÿçš„å†…å®¹è®©ç”¨æˆ·å¯ä»¥æ·±å…¥å…¶ä¸­ï¼Ÿ</td> 
  </tr> 
  <tr> 
   <td>æ˜¯å¦å¯ç”¨ï¼Ÿ</td> 
   <td>é¡µé¢æ˜¯å¦ç¹å¿™ï¼Œç”¨æˆ·æ˜¯å¦å¯ä»¥ä¸é¡µé¢è¿›è¡Œäº¤äº’ï¼Ÿ</td> 
  </tr> 
  <tr> 
   <td>æ˜¯å¦ä»¤äººæ„‰å¿«ï¼Ÿ</td> 
   <td>äº¤äº’æ˜¯å¦æµç•…è‡ªç„¶ï¼Œæ²¡æœ‰å»¶è¿Ÿå’Œå¡é¡¿ï¼Ÿ</td> 
  </tr> 
 </tbody> 
</table>

## æ ¹æ®é‡‡é›†æ–¹å¼ä¸åŒï¼Œæ€§èƒ½æŒ‡æ ‡çš„å‡ ç§å½¢å¼ 

æ ¹æ®æµ‹é‡æ–¹å¼çš„ä¸åŒï¼Œæ€§èƒ½æ•°æ®å¯ä»¥åˆ†ä¸ºï¼šLab Data å’Œ Field Data

### Lab Data / SYN 

SYN å³ synthetic monitoringï¼Œæ”¶é›†å½¢å¼ä¹Ÿæœ‰å« in the lab

Lab Data æ˜¯åœ¨å¯æ§çš„æ¡ä»¶ä¸‹ï¼Œç‰¹å®šçš„æœºå‹ï¼Œç‰¹å®šçš„ç½‘ç»œç¯å¢ƒï¼Œæ”¶é›†çš„æ€§èƒ½æ•°æ®ã€‚ä¸€ä¸ªä½¿ç”¨åœºæ™¯æ˜¯ï¼Œæ–°é¡µé¢å¼€å‘çš„æ—¶å€™ï¼Œé¡µé¢å‘å¸ƒåˆ°ç”Ÿäº§ç¯å¢ƒä¸­ä¹‹å‰ï¼Œæ˜¯æ²¡åŠæ³•åŸºäºçœŸå®ç”¨æˆ·åšæ€§èƒ½æŒ‡æ ‡æµ‹é‡çš„ï¼Œæ­¤æ—¶ï¼Œæƒ³äº†è§£ä¹Ÿæ²¡æ€§èƒ½æƒ…å†µï¼Œå¯ä»¥é€šè¿‡ Lab æ–¹å¼æ”¶é›†å’Œæ£€æŸ¥ã€‚

### Field Data / RUM 

RUM å³ Real User Monitoringï¼Œæ”¶é›†å½¢å¼ä¹Ÿæœ‰å« in the Filed

Lab çš„æ–¹å¼æµ‹é‡è™½ç„¶èƒ½ååº”æ€§èƒ½æƒ…å†µï¼Œä½†æ˜¯çœŸå®ç”¨æˆ·å› æœºå‹å’Œç½‘ç»œæƒ…å†µå„å¼‚ï¼Œé¡µé¢åŠ è½½å¯¹äºä¸åŒç”¨æˆ·å…·æœ‰å¾ˆå¤§çš„ä¸ç¡®å®šæ€§ï¼ŒLab æ•°æ®å¹¶ä¸ä¸€å®šæ˜¯çœŸå®ç”¨æˆ·çš„å®é™…æƒ…å†µã€‚è€Œ filed æ•°æ®å¾ˆå¥½çš„è§£å†³äº†è¿™ä¸ªé—®é¢˜ï¼Œæœ‰ä¸€å®šçš„ä»£ç ä¾µå…¥æ€§ï¼Œè®°å½•çœŸå®ç”¨æˆ·çš„æ€§èƒ½æ•°æ®ï¼Œé€šè¿‡ RUM æ•°æ®å¯ä»¥å‘ç°ä¸€äº› Lab æ•°æ®ä¸‹å¾ˆéš¾æš´éœ²å‡ºæ¥çš„æ€§èƒ½å¼‚å¸¸ã€‚

## RAIL Model 

æˆ‘ä»¬å…ˆæ¥çœ‹ä¸‹ RAIL è¿™å‡ ä¸ªå­—æ¯åˆ†åˆ«å¯¹åº”ä»€ä¹ˆï¼Ÿ

R: response

A: animation

I: idle

L: load

RAIL æ˜¯ Google æå‡ºçš„ä»¥ç”¨æˆ·ä¸ºä¸­å¿ƒçš„ä¸€å¥—æ€§èƒ½æ¨¡å‹ï¼Œä»å„ä¸ªç»´åº¦ååº”ä¸€ä¸ªç½‘ç«™çš„æ€§èƒ½æƒ…å†µï¼ŒåŒæ—¶æä¾›ä¸€ç»„æ€§èƒ½ç›®æ ‡ä¾›å‚è€ƒğŸ‘‡

 *  Response: 50ms å†…å¯¹äº‹ä»¶åšå‡ºå“åº”
 *  Animation: åŠ¨ç”» 10 ms å†…ç”Ÿæˆå†…ä¸€å¸§ï¼ˆæ¯å¸§è€—æ—¶ 16msï¼Œç”¨æˆ·ä¼šæ„Ÿåˆ°åŠ¨ç”»æµç•…ï¼Œä¸ºä»€ä¹ˆè¿™é‡Œæ˜¯ 10msï¼Ÿï¼‰
 *  Idle: æœ€å¤§åŒ–çš„åˆ©ç”¨ä¸Šç©ºé—²æ—¶é—´
 *  Load: åœ¨ 5s å†…å®Œæˆå†…å®¹ä¼ è¾“å¹¶è¾¾åˆ°ç”¨æˆ·å¯äº¤äº’

# æ€§èƒ½æŒ‡æ ‡æ˜¯æ€ä¹ˆé‡‡é›†çš„ 

## æ€§èƒ½æŒ‡æ ‡ç›¸å…³çš„ API åŠé‡‡é›†æ–¹å¼ 

### Performance Observer\[1\] 

Performance Observer API ä¸‹åŒ…å«ä¸€ç»„æ€§èƒ½ç›‘æµ‹ç›¸å…³çš„ API

 *  Paint Timing API

 *  Largest Contentful Paint API

 *  Event Timing API

 *  Navigation Timing API

 *  Layout Instability API

 *  Long Tasks API

 *  Resource Timing API

ä¸‹é¢æŒ‰ç…§ä¸åŒæŒ‡æ ‡çš„æ”¶é›†ç”¨åˆ°çš„ API ä¾æ¬¡ä»‹ç»å®ƒä»¬æ˜¯æ€ä¹ˆç”¨çš„ã€‚

#### Paint Timing API\[2\] 

ç”¨äºæ”¶é›† FP / FCP

```java
newÂ PerformanceObserver((list)Â =>Â {

Â Â forÂ (constÂ entryÂ ofÂ list.getEntries())Â {

Â Â Â Â console.log('FCP:Â ',Â entry.startTime);

Â Â }

}).observe({

Â Â type:Â 'first-contentful-paint',

Â Â buffered:Â true,

});



newÂ PerformanceObserver((list)Â =>Â {

Â Â forÂ (constÂ entryÂ ofÂ list.getEntries())Â {

Â Â Â Â console.log('FP:Â ',Â entry.startTime);

Â Â }

}).observe({

Â Â type:Â 'first-paint',

Â Â buffered:Â true,

});
```

#### Largest Contentful Paint API\[3\] 

ç”¨äºæ”¶é›† LCP

largest-contentful-paint äº‹ä»¶ä¼šåœ¨é¡µé¢åŠ è½½è¿‡ç¨‹ä¸­æ ¹æ®æ­¤æ—¶å·²æ¸²æŸ“æœ€å¤§å…ƒç´ çš„å˜åŒ–ï¼Œä¸æ–­çš„è¢«è§¦å‘ï¼Œå®é™…ä¸ŠæŠ¥ä¸­ä¼šä¸€ç›´ç›‘å¬è¿™äº›å˜åŒ–ï¼Œç›´åˆ°ç”¨æˆ·ä¸é¡µé¢å‘ç”Ÿäº¤äº’è¡Œä¸ºï¼ˆæ¯”å¦‚ clickã€keydownï¼‰æˆ–è€…é¡µé¢è¢«éšè—æˆ–è€…é¡µé¢è¢« unload ç­‰ï¼Œå–ç›‘å¬åˆ°çš„æœ€åå€¼åšä¸ŠæŠ¥ã€‚

```java
newÂ PerformanceObserver(entryListÂ =>Â {

Â Â forÂ (constÂ entryÂ ofÂ entryList.getEntries())Â {

Â Â Â Â console.log('LCP:Â ',Â entry.startTime);

Â Â }

}).observe({

Â Â Â Â type:Â 'largest-contentful-paint',

Â Â Â Â buffered:Â true

});
```

![image_841487ce.png](http://markdown.liangtengyu.com:9999/images//image_841487ce.png)![image_a89a768b.png](http://markdown.liangtengyu.com:9999/images//image_a89a768b.png)![image_677189e0.png](http://markdown.liangtengyu.com:9999/images//image_677189e0.png)![image_c00fc326.png](http://markdown.liangtengyu.com:9999/images//image_c00fc326.png)

![image_eae43bdf.png](http://markdown.liangtengyu.com:9999/images//image_eae43bdf.png)

å®Œæ•´ç‰ˆä»£ç å‚è€ƒğŸ‘‰ https://github.com/GoogleChrome/web-vitals/blob/main/src/getLCP.ts

è¿™ä¸ªæŒ‡æ ‡æ˜¯ Core Web Vitalsï¼Œä½†æ˜¯å…¼å®¹æ€§ä¸å¥½ï¼ŒiOS ä¸‹éƒ½æ˜¯ä¸æ”¯æŒçš„ğŸ™…

![image_cc1d1d9d.png](http://markdown.liangtengyu.com:9999/images//image_cc1d1d9d.png)

#### Event Timing API\[4\] 

ç”¨äºæ”¶é›† FID

ç›‘å¬ç”¨æˆ·çš„ç¬¬ä¸€æ¬¡è¾“å…¥ï¼ˆfirst-inputï¼‰äº‹ä»¶ï¼ŒFID = å¼€å§‹å¤„ç† input çš„æ—¶é—´ - input æ“ä½œçš„èµ·å§‹æ—¶é—´

```java
newÂ PerformanceObserver(listÂ =>Â {

Â Â forÂ (constÂ entryÂ ofÂ list.getEntries())Â {

Â Â Â Â //Â å¼€å§‹å¤„ç†Â inputÂ çš„æ—¶é—´Â -Â inputÂ æ“ä½œçš„èµ·å§‹æ—¶é—´

Â Â Â Â constÂ FIDÂ =Â entry.processingStartÂ -Â entry.startTime;Â 

Â Â Â Â console.log('FID:',Â FID);

Â Â }

}).observe({

Â Â type:Â 'first-input',

Â Â buffered:Â true,

});
```

#### Navigation Timing 1.0\[5\] æˆ– Navigation Timing 2.0\[6\] 

ç”¨äºæ”¶é›† Load / DOMContentLoaded

![image_f3c4aa66.png](http://markdown.liangtengyu.com:9999/images//image_f3c4aa66.png)

```java
newÂ PerformanceObserver(listÂ =>Â {

Â Â forÂ (constÂ entryÂ ofÂ list.getEntries())Â {

Â Â Â Â constÂ LoadÂ =Â entry.loadEventStartÂ -Â entry.fetchStart;

Â Â Â Â console.log('Load:',Â Load);

Â Â }

}).observe({

Â Â type:Â 'navigation',

Â Â buffered:Â true,

});



newÂ PerformanceObserver(listÂ =>Â {

Â Â forÂ (constÂ entryÂ ofÂ list.getEntries())Â {

Â Â Â Â constÂ DOMContentLoadedÂ =Â entry.domContentLoadedEventStartÂ -Â entry.fetchStart;

Â Â Â Â console.log('DOMContentLoaded:',Â DOMContentLoaded);

Â Â }

}).observe({

Â Â type:Â 'navigation',

Â Â buffered:Â true,

});
```

#### Layout Instability API\[7\] 

æ”¶é›† CLS: å°†åŠ è½½è¿‡ç¨‹åˆ†å—ï¼ˆsessionï¼‰ï¼Œç›‘å¬ layout-shift å˜åŒ–è·å¾—æ¯æ¬¡å¸ƒå±€å˜åŠ¨çš„ value å€¼ï¼Œç»Ÿè®¡æ¯ä¸ª session çš„å¸ƒå±€å˜åŠ¨åˆ†æ•°ï¼Œæœ€å¤§çš„å¸ƒå±€å˜åŠ¨åˆ†æ•°æ—¶æ®µï¼Œå³ä¸º CLSã€‚

```java
letÂ sessionEntriesÂ =Â [];

letÂ sessionValueÂ =Â 0;

letÂ metricÂ =Â {

Â Â value:Â 0

}

newÂ PerformanceObserver(entryListÂ =>Â {

Â Â forÂ (constÂ entryÂ ofÂ entryList.getEntries())Â {

Â Â Â Â ifÂ (!entry.hadRecentInput)Â {

Â Â Â Â Â Â constÂ firstSessionEntryÂ =Â sessionEntries[0];

Â Â Â Â Â Â constÂ lastSessionEntryÂ =Â sessionEntries[sessionEntries.lengthÂ -Â 1];



Â Â Â Â Â Â //Â å¦‚æœæ—¶é—´é è¿‘ä¸Šä¸€ä¸ªÂ session,Â å°†æœ¬è½®Â layout-shiftÂ ç´¯åŠ è¿›ä¸Šä¸€ä¸ªÂ session

Â Â Â Â Â Â ifÂ (sessionValueÂ &&

Â Â Â Â Â Â Â Â Â Â entry.startTimeÂ -Â lastSessionEntry.startTimeÂ <Â 1000Â &&

Â Â Â Â Â Â Â Â Â Â entry.startTimeÂ -Â firstSessionEntry.startTimeÂ <Â 5000)Â {

Â Â Â Â Â Â Â Â sessionValueÂ +=Â entry.value;

Â Â Â Â Â Â Â Â sessionEntries.push(entry);

Â Â Â Â Â Â }Â elseÂ {Â //Â æ–°èµ·ä¸€ä¸ªÂ session

Â Â Â Â Â Â Â Â sessionValueÂ =Â entry.value;

Â Â Â Â Â Â Â Â sessionEntriesÂ =Â [entry];

Â Â Â Â Â Â }



Â Â Â Â Â Â //Â å¦‚æœå½“å‰Â sessionÂ çš„Â valueÂ å¤§äºä¹‹å‰çš„æœ€å¤§å€¼ï¼Œæ›¿æ¢ä¸ºç°åœ¨è¿™ä¸ªå¤§çš„

Â Â Â Â Â Â ifÂ (sessionValueÂ >Â metric.value)Â {

Â Â Â Â Â Â Â Â metric.valueÂ =Â sessionValue;

Â Â Â Â Â Â Â Â metric.entriesÂ =Â sessionEntries;

Â Â Â Â Â Â Â Â console.log('CLS:Â ',Â metric)

Â Â Â Â Â Â }

Â Â Â Â }

Â Â }

}).observe({

Â Â Â Â type:Â 'layout-shift',

Â Â Â Â buffered:Â true

});
```

å®Œæ•´ä»£ç è§ğŸ‘‰ https://github.com/GoogleChrome/web-vitals/blob/main/src/getCLS.ts

#### Long Tasks API\[8\] & Resource Timing API\[9\] 

TTI çš„é‡‡é›†ä¾èµ–è¿™ä¸¤ä¸ª APIï¼Œè®¡ç®—è¿‡ç¨‹ï¼š

> 1.  å…ˆé‡‡é›† FCPï¼Œä½œä¸ºèµ·ç‚¹
> 2.  æ²¿æ—¶é—´è½´æ­£å‘æœç´¢æ—¶é•¿è‡³å°‘ä¸º 5 ç§’çš„å®‰é™çª—å£ï¼ˆ å®‰é™çª—å£ï¼šæ²¡æœ‰ Long Task ä¸”ä¸è¶…è¿‡ä¸¤ä¸ªæ­£åœ¨å¤„ç†çš„ç½‘ç»œ GET è¯·æ±‚ï¼‰
> 3.  æ²¿æ—¶é—´è½´åå‘æœç´¢å®‰é™çª—å£ä¹‹å‰çš„æœ€åä¸€ä¸ªé•¿ä»»åŠ¡ï¼Œå¦‚æœæ²¡æœ‰æ‰¾åˆ°é•¿ä»»åŠ¡ï¼Œåˆ™åœ¨ FCP æ­¥éª¤åœæ­¢æ‰§è¡Œ
> 4.  TTI æ˜¯å®‰é™çª—å£ä¹‹å‰æœ€åä¸€ä¸ªé•¿ä»»åŠ¡çš„ç»“æŸæ—¶é—´ï¼Œå¦‚æœæ²¡æœ‰æ‰¾åˆ°é•¿ä»»åŠ¡ï¼Œåˆ™ä¸ FCP å€¼ç›¸åŒ
> 
> â€”â€” Time to Interactive (TTI)\[10\]

![image_b9b8343f.png](http://markdown.liangtengyu.com:9999/images//image_b9b8343f.png)

### Mutation\[11\]\[12\]Observer\[13\] 

æ”¶é›† FMPï¼šé€šè¿‡ MutationObserver å¯¹ DOM å˜åŒ–è¿›è¡Œç›‘å¬ï¼Œæ¯æ¬¡å›è°ƒæ ¹æ®æ–°æ—§ DOM æ•°é‡ã€ç§ç±»ã€æ·±åº¦ç­‰ï¼Œè®¡ç®—å‡ºå½“å‰ DOM æ ‘çš„åˆ†æ•°ï¼Œåˆ†æ•°å˜åŒ–æœ€å‰§çƒˆçš„æ—¶åˆ»è§†ä¸º FMP ï¼Œ`Load` äº‹ä»¶è§¦å‘å 200ms åœæ­¢ç›‘å¬ï¼Œå–æœ€å¤§å˜åŠ¨çš„è®°å½•åšä¸ŠæŠ¥ã€‚

```java
newÂ MutationObserver(()Â =>Â {

Â Â //Â è¿™é‡Œæ˜¯å‰§çƒˆç¨‹åº¦åˆ†çš„è®¡ç®—

}).observe(document,Â {

Â Â childList:Â true,

Â Â subtree:Â true,

});
```

## ä¸šç•Œæ€§èƒ½æŒ‡æ ‡é‡‡é›†å·¥å…· 

### In the Lab 

 *  Chrome DevTools \[14\]

 *  Lighthouse \[15\]

 *  WebPageTest \[16\]

### In the Field 

 *  web-vitals \[17\]

# å‚è€ƒ 

Web Vitals\[18\]

Largest Contentful Paint (LCP)\[19\]

Cumulative Layout Shift (CLS)\[20\]

First Input Delay (FID)\[21\]

Measure performance with the RAIL model\[22\]

### å‚è€ƒèµ„æ–™ 

\[1\]

Performance Observer: https://www.w3.org/TR/performance-timeline-2/

 \[2\]

Paint Timing API: https://w3c.github.io/paint-timing/\#sec-PerformancePaintTiming

 \[3\]

Largest Contentful Paint API: https://wicg.github.io/largest-contentful-paint/

 \[4\]

Event Timing API: https://wicg.github.io/event-timing/

 \[5\]

Navigation Timing 1.0: https://www.w3.org/TR/navigation-timing/

 \[6\]

Navigation Timing 2.0: https://www.w3.org/TR/navigation-timing-2/

 \[7\]

Layout Instability API: https://wicg.github.io/layout-instability/

 \[8\]

Long Tasks API: https://www.w3.org/TR/2017/WD-longtasks-1-20170907/

 \[9\]

Resource Timing API: https://www.w3.org/TR/resource-timing-2/

 \[10\]

Time to Interactive (TTI): https://web.dev/tti/

 \[11\]

Mutation: https://dom.spec.whatwg.org/\#mutationobserver

 \[12\]

: https://dom.spec.whatwg.org/\#mutationobserver

 \[13\]

Observer: https://dom.spec.whatwg.org/\#mutationobserver

 \[14\]

Chrome DevTools: https://developers.google.com/web/tools/chrome-devtools/

 \[15\]

Lighthouse: https://developers.google.com/web/tools/lighthouse/

 \[16\]

WebPageTest: https://www.webpagetest.org/

 \[17\]

web-vitals: https://github.com/GoogleChrome/web-vitals

 \[18\]

Web Vitals: https://web.dev/vitals/

 \[19\]

Largest Contentful Paint (LCP): http://web.dev/lcp

 \[20\]

Cumulative Layout Shift (CLS): https://web.dev/cls/

 \[21\]

First Input Delay (FID): https://web.dev/fid/

 \[22\]

Measure performance with the RAIL model: https://web.dev/rail/

  


å¾€æœŸæ¨è

[React å…¨å±€çŠ¶æ€ç®¡ç†çš„ 3 ç§åº•å±‚æœºåˆ¶][React _ 3] [æ·±å…¥å¯¹æ¯” eslint æ’ä»¶ å’Œ babel æ’ä»¶çš„å¼‚åŒç‚¹][eslint _ _ babel] [å…­ä¸ªé—®é¢˜è®©ä½ æ›´æ‡‚ React Fiberï¼Œäº†è§£æ¡†æ¶åº•å±‚æ¸²æŸ“é€»è¾‘][React Fiber] [ä¸€æ–‡é€Ÿè§ˆ TypeScript è£…é¥°å™¨ ä¸ IoC æœºåˆ¶][TypeScript _ _ IoC]

[ä½ ä¸çŸ¥é“ CSS å¯ä»¥åšçš„ 4 ä»¶äº‹][CSS _ 4]

ç‚¹å‡»ä¸‹æ–¹â€œæŠ€æœ¯æ¼«è°ˆâ€ï¼Œé€‰æ‹©â€œè®¾ä¸ºæ˜Ÿæ ‡â€  
 ç¬¬ä¸€æ—¶é—´å…³æ³¨æŠ€æœ¯å¹²è´§ï¼


[React _ 3]: http://mp.weixin.qq.com/s?__biz=Mzg5MTU5ODYxOA==&mid=2247489386&idx=1&sn=099419dd6620abd981eaad0017670631&chksm=cfcbb51ff8bc3c09be930f345e303051b257e53e6bd5e7f6022da482fbb4368879879c064cfe&scene=21#wechat_redirect
[eslint _ _ babel]: http://mp.weixin.qq.com/s?__biz=Mzg5MTU5ODYxOA==&mid=2247489343&idx=1&sn=8c75bbd6e895564ebdb066ccd0e5ff9a&chksm=cfcbb54af8bc3c5cf4a6958e0bb316c5d1aaa7b93e098f4cbf022f93ae7dd4c69e771b19de2e&scene=21#wechat_redirect
[React Fiber]: http://mp.weixin.qq.com/s?__biz=Mzg5MTU5ODYxOA==&mid=2247489106&idx=1&sn=f4b838d82051269bbb8d6116d946aa56&chksm=cfcbb427f8bc3d31fb17eda11014a15e11bac9376962bf6da977ba96bf495987e78bb4da6180&scene=21#wechat_redirect
[TypeScript _ _ IoC]: http://mp.weixin.qq.com/s?__biz=Mzg5MTU5ODYxOA==&mid=2247489602&idx=1&sn=9cdfc5008d177185a776b1922b7baa5f&chksm=cfcbba37f8bc332123f3ec23d793fee9e849b48cd7824534b5b08a6fb67dadd6390cacf96591&scene=21#wechat_redirect
[CSS _ 4]: http://mp.weixin.qq.com/s?__biz=Mzg5MTU5ODYxOA==&mid=2247489339&idx=2&sn=012264905d7ca2430e6d1bd8ae6aa601&chksm=cfcbb54ef8bc3c587f5d54bbb489f80e30b06df67a6b219356ed208bacacfcf0610ef5b0beb0&scene=21#wechat_redirect